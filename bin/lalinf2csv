#!/usr/bin/env python

"""converts a LALInference.dat file into a more standard CSV format similar to what Phil produces
"""
__author__ = 'Reed Essick (reed.essick@gmail.com)'

#-------------------------------------------------

import numpy as np

from argparse import ArgumentParser

### non-standard libraries
from universality.utils import io

#-------------------------------------------------

parser = ArgumentParser(description=__doc__)

parser.add_argument('inpath', type=str)
parser.add_argument('outpath', default=None, type=str)

parser.add_argument('-v', '--verbose', default=False, action='store_true')

args = parser.parse_args()

if args.outpath is None:
    args.outpath = '.'.join(args.inpath.split('.')[:-1]+['csv'])
else:
    assert args.outpath!=args.inpath, 'output filename is identical to input filename!'

#-------------------------------------------------

### read input file
if args.verbose:
    print('reading samples from: '+args.inpath)
data = np.genfromtxt(args.inpath, names=True)

if args.verbose:
    print('writing samples to: '+args.outpath)
io.write(args.outpath, data, data.dtype.names)
