#!/usr/bin/env python

__doc__ = 'converts a LALInference.dat file into a more standard CSV format similar to what Phil produces'
__usage__ = 'lalinf2csv input.dat [output.csv]'
__author__ = 'reed.essick@ligo.org'

#-------------------------------------------------

import numpy as np

from argparse import ArgumentParser

#-------------------------------------------------

parser = ArgumentParser(description=__doc__)

parser.add_argument('inpath', type=str)
parser.add_argument('outpath', default=None, type=str)

parser.add_argument('-v', '--verbose', default=False, action='store_true')

args = parser.parse_args()

if args.outpath is None:
    args.outpath = '.'.join(args.inpath.split('.')[:-1]+['csv'])
else:
    assert args.outpath!=args.inpath, 'output filename is identical to input filename!'

#-------------------------------------------------

### read input file
if args.verbose:
    print('reading samples from: '+args.inpath)
    print('writing samples to: '+args.outpath)
with open(args.inpath, 'r') as infile:
    with open(args.outpath, 'w') as outfile:
        for line in infile:
            outfile.write(','.join(line.strip().split())+'\n')
